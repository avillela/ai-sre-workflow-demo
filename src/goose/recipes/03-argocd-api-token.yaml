version: 1.0.0
title: Generate ArgoCD API token
description: Generate an ArgoCD API token for the admin account
instructions: |
  
  ## Role
  
  Use role from `.goosehints`.

parameters:
  - key: env_file
    input_type: string
    requirement: required
    default: "src/goose/config/.env"
    description: "Env file path (includes .env file)"
  - key: context_name
    input_type: string
    requirement: required
    default: "otel"
    description: "k8s context name"

sub_recipes:
  - name: "token_config"
    path: "./sub_recipes/argocd-api-token-config.yaml"
    values:
      context_name: "{{ context_name }}"
  - name: "port_forward"
    path: "./sub_recipes/port-forward.yaml"
    values:
      forward_port: "9080"
      context_name: "{{ context_name }}"      
  - name: "token_gen"
    path: "./sub_recipes/argocd-api-token-generation.yaml"
    values:
      env_file: "{{ env_file }}"
      context_name: "{{ context_name }}"
      # include_dependencies: "true"

extensions:
- type: builtin
  name: developer
  display_name: Developer Tools
  description: null
  timeout: 300
  bundled: true
  available_tools: []

prompt: |

  ## Objective

  Generate an ArgoCD API token by running the sub-recipes sequentially, 
  
  Sub-recipe order:
    1. token_config
    2. port_forward
    3. token_gen
    
  ## Output

  * Format output per "Output Guidelines" from `.goosehints`. Include only:
    - Recipe name
    - Recipe-specific output fields
    - Recipe execution status

settings:
  goose_provider: github_copilot
  # goose_model: claude-sonnet-4.5
  temperature: 0.5
author:
  contact: avillela
