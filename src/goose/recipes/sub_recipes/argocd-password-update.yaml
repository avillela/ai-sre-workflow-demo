version: 1.0.0
title: Update ArgoCD initial password
description: Update the ArgoCD password from the initial admin password.
instructions: |

  ## Role
  
  Use role from `.goosehints`.

  ## ArgoCD guidance

  ### Get ArgoCD initial password

  ```bash
  kubectl --context {{ context_name }} get secret argocd-initial-admin-secret -n argocd -o jsonpath="{.data.password}" | base64 --decode
  ```

prompt: |

  ## Objective

  Update the initial ArgoCD admin password from the value on initial installation.
  
  Steps:
  1. Get ArgoCD initial password
  2. Login to ArgoCD using the `argocd` CLI:
    * ArgoCD server is the value of the environment variable ARGOCD_BASE_URL
    * `username`: `admin`
    * `password`: the value retrieved from step 1
  3. Use the `argocd` CLI to update the password, where:
    * `current-password`: the value retrieved from Step 1
    * `new-password`: the value of the environment variable ARGOCD_PASSWORD
  4. Confirm successful login with new password by running `argocd login`, where:
    * `password`: the value of the environment variable ARGOCD_PASSWORD
    * `username`: `admin`
    * ArgoCD URL is the value of the environment variable ARGOCD_BASE_URL
  5. Summarize results.

  ## Source

  ArgoCD CLI resources:
  * ArgoCD login: https://argo-cd.readthedocs.io/en/stable/user-guide/commands/argocd_login/
  * Change ArgoCD password: https://argo-cd.readthedocs.io/en/stable/user-guide/commands/argocd_account_update-password/

  ## Output

  Format output per "Output Guidelines" from `.goosehints`. Include only:
  * Password change status: success/failed
  * Login status with new password: success/failed

parameters:
  - key: context_name
    input_type: string
    requirement: required
    default: "otel"
    description: "k8s context name"

extensions:
- type: builtin
  name: developer
  display_name: Developer Tools
  description: null
  timeout: 300
  bundled: true
  available_tools: []

settings:
  goose_provider: github_copilot
  # goose_model: claude-sonnet-4.5
  temperature: 0.5
author:
  contact: avillela
